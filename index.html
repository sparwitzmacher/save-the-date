<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Save the Date ‚Äì Kim & Matthias üíç</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&display=swap" rel="stylesheet" />
    <style>
      body {
        margin: 0;
        font-family: "Playfair Display", serif;
        color: #333;
        text-align: center;
        background: linear-gradient(135deg, #fff5f7, #fdf0d5);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
      }
      h1 { font-size: 2.5rem; margin-bottom: 1rem; color: #b56576; }
      video {
        width: 90%; max-width: 700px; border-radius: 16px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.15); margin-bottom: 2rem;
      }
      button {
        background-color: #b56576; color: white; border: none; border-radius: 30px;
        padding: 12px 28px; font-size: 1.2rem; cursor: pointer;
        transition: all 0.3s ease;
      }
      button:hover { background-color: #8d4d5f; transform: scale(1.05); }
      p { font-size: 1.1rem; color: #555; }
      footer { margin-top: 2rem; font-size: 0.9rem; color: #888; }
    </style>
  </head>

  <body>
    <h1>Save the Date ‚Äì Kim & Matthias üíï</h1>

    <video controls>
      <source src="video.mp4" type="video/mp4" />
      Dein Browser unterst√ºtzt kein Videoelement.
    </video>

    <p>Hat dir das Video gefallen? M√∂chtest du dir den Hochzeitstermin vormerken?</p>
    <button id="yesButton">Ja, ich bin dabei!</button>

    <footer>Wir freuen uns auf euch ‚Äì Kim & Matthias</footer>

    <script>
      document.getElementById("yesButton").addEventListener("click", async () => {
        try {
          await fetch("/.netlify/functions/vote-yes", { method: "POST" });

          const title = "Hochzeit von Kim & Matthias üíç";
          const desc = "Wir freuen uns auf dich! Save the Date üíï";
          const location = "Scheunenwirtin, Helmut-Ginzkey-Weg 10, 73566 Bartholom√§";
          const start = "20260814T130000Z";
          const end = "20260814T230000Z";

          const ics = `
BEGIN:VCALENDAR
VERSION:2.0
PRODID:-//KimUndMatthias//SaveTheDate//DE
BEGIN:VEVENT
UID:${Date.now()}@kimundmatthias.de
DTSTAMP:${new Date().toISOString().replace(/[-:]/g,"").split(".")[0]}Z
DTSTART:${start}
DTEND:${end}
SUMMARY:${title}
LOCATION:${location}
DESCRIPTION:${desc}
END:VEVENT
END:VCALENDAR`;

          const blob = new Blob([ics], { type: "text/calendar;charset=utf-8" });
          const url = URL.createObjectURL(blob);
          const a = document.createElement("a");
          a.href = url;
          a.download = "Save-the-Date.ics";
          a.click();
          URL.revokeObjectURL(url);

          alert("üéâ Danke! Dein Termin wurde gespeichert.");
        } catch (e) {
          console.error(e);
          alert("Etwas ist schiefgelaufen üòî Bitte sp√§ter nochmal versuchen.");
        }
      });
    </script>
  </body>
</html>
